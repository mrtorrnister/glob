<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Historyczna Europa 1700-2025</title>
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.120/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.120/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
  <style>
    html, body, #cesiumContainer {
      width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden;
    }
  </style>
</head>
<body>
  <div id="cesiumContainer"></div>
  <script>
    const viewer = new Cesium.Viewer('cesiumContainer', {
      timeline: true,
      animation: true
    });

    // Timeline od 1700 do 2025
    const start = Cesium.JulianDate.fromDate(new Date(1700,0,1));
    const stop  = Cesium.JulianDate.fromDate(new Date(2025,0,1));
    viewer.clock.startTime = start.clone();
    viewer.clock.stopTime = stop.clone();
    viewer.clock.currentTime = start.clone();
    viewer.clock.clockRange = Cesium.ClockRange.LOOP_STOP;
    viewer.clock.multiplier = 31536000; // 1 sek = 1 rok
    viewer.timeline.zoomTo(start, stop);

    // Wczytanie GeoJSON
    Cesium.GeoJsonDataSource.load('polska.json', { clampToGround: true })
    .then(function(dataSource) {
      viewer.dataSources.add(dataSource);
      const entities = dataSource.entities.values;

      for (let i=0; i<entities.length; i++){
        const entity = entities[i];
        const props = entity.properties;

        if(props && props.start && props.end){
          const startDate = Cesium.JulianDate.fromDate(new Date(props.start.getValue()));
          const endDate   = Cesium.JulianDate.fromDate(new Date(props.end.getValue()));

          entity.availability = new Cesium.TimeIntervalCollection([new Cesium.TimeInterval({
            start: startDate,
            stop:  endDate
          })]);

          // Kolory państw
          const n = props.name.getValue();
          const colors = {
            "Austro-Węgry": Cesium.Color.RED.withAlpha(0.4),
            "Austro-Węgry-1918-06": Cesium.Color.RED.withAlpha(0.3),
            "Austro-Węgry-1918-09": Cesium.Color.RED.withAlpha(0.2),
            "Austria": Cesium.Color.BLUE.withAlpha(0.4),
            "Węgry": Cesium.Color.GREEN.withAlpha(0.4),
            "Czechosłowacja": Cesium.Color.YELLOW.withAlpha(0.4),
            "Polska": Cesium.Color.CYAN.withAlpha(0.4),
            "Prusy/Niemcy": Cesium.Color.ORANGE.withAlpha(0.4),
            "Niemcy": Cesium.Color.ORANGE.withAlpha(0.6),
            "Francja": Cesium.Color.GREEN.withAlpha(0.6),
            "Hiszpania": Cesium.Color.MAGENTA.withAlpha(0.6),
            "Wielka Brytania": Cesium.Color.BROWN.withAlpha(0.6),
            "Włochy": Cesium.Color.PINK.withAlpha(0.6),
            "Rumunia": Cesium.Color.LIGHTGREEN.withAlpha(0.6),
            "Jugosławia": Cesium.Color.LIGHTBLUE.withAlpha(0.6)
          };
          entity.polygon.material = colors[n] || Cesium.Color.GRAY.withAlpha(0.4);
          entity.polygon.outline = true;
          entity.polygon.outlineColor = Cesium.Color.BLACK;
        }
      }
    });
  </script>
</body>
</html>
